(this.webpackJsonpdeparture_board=this.webpackJsonpdeparture_board||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(8),l=a.n(i),u=(a(14),a(2)),o=a(3),c=a(5),s=a(4),d=a(6),m=(a(15),a(1)),h=(a(17),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(c.a)(this,Object(s.a)(t).call(this,e))).state={date:new Date},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timerID=setInterval((function(){return e.tick()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"tick",value:function(){this.setState({date:new Date})}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("h1",null,"SOUTH STATION DEPARTURE BOARD"),n.a.createElement("h2",null," ",this.state.date.toLocaleString()))}}]),t}(n.a.Component));function p(e){if(e.data.length<=0)return[];var t=[],a=e.included.reduce((function(e,t){return e[t.id]=t,e}),{}),r=!0,n=!1,i=void 0;try{for(var l,u=e.data[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var o=l.value,c={},s=a[o.relationships.schedule.data.id],d=a[o.relationships.route.data.id],m=a[o.relationships.stop.data.id],h=a[o.relationships.trip.data.id];c.rawArrival=s.attributes.arrival_time,c.arrival=c.rawArrival?new Date(c.rawArrival).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):" - -: - - ",c.rawDeparture=s.attributes.departure_time,c.departure=c.rawDeparture?new Date(c.rawDeparture).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):" - - : - - ",c.status=o.attributes.status,c.to=d.attributes.direction_destinations[s.attributes.direction_id],c.from=d.attributes.direction_destinations[(s.attributes.direction_id+1)%2],c.track_number=m.attributes.platform_code,c.train_number=h.attributes.name,t.push(c)}}catch(p){n=!0,i=p}finally{try{r||null==u.return||u.return()}finally{if(n)throw i}}return t.sort((function(e,t){var a=e.rawArrival||e.rawDeparture,r=t.rawArrival||t.rawDeparture;return a!==r?new Date(a)>new Date(r)?1:-1:0})),t}var v=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(c.a)(this,Object(s.a)(t).call(this,e))).state={model:[]},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"tick",value:function(){var e=this;this.request=new XMLHttpRequest,this.request.onload=function(){var t=JSON.parse(e.request.response);e.setState({model:p(t)})},this.request.open("GET","https://api-v3.mbta.com/predictions?include=trip,stop,schedule,route&filter%5Bstop%5D=place-sstat&filter[route_type]=2&fields[prediction]=arrival_time,departure_time,status",!0),this.request.send()}},{key:"componentDidMount",value:function(){var e=this;this.tick(),this.timerID=setInterval((function(){return e.tick()}),15e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"render",value:function(){return n.a.createElement(m.Table,null,n.a.createElement(m.Thead,null,n.a.createElement(m.Tr,null,n.a.createElement(m.Th,null,"Arrival"),n.a.createElement(m.Th,null,"Departure"),n.a.createElement(m.Th,null,"From"),n.a.createElement(m.Th,null,"To"),n.a.createElement(m.Th,null,"Train#"),n.a.createElement(m.Th,null,"Track#"),n.a.createElement(m.Th,null,"Status"))),n.a.createElement(m.Tbody,null,this.state.model.map((function(e){return n.a.createElement(m.Tr,null,n.a.createElement(m.Td,null,e.arrival),n.a.createElement(m.Td,null,e.departure),n.a.createElement(m.Td,null,e.from),n.a.createElement(m.Td,null,e.to),n.a.createElement(m.Td,null,e.train_number),n.a.createElement(m.Td,null,e.track_number),n.a.createElement(m.Td,null,e.status))}))))}}]),t}(n.a.Component);var f=function(){return n.a.createElement("div",null,n.a.createElement(h,null),n.a.createElement(v,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(f,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},9:function(e,t,a){e.exports=a(18)}},[[9,1,2]]]);
//# sourceMappingURL=main.237c1d58.chunk.js.map